<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Calibration (1D) · NMRAnalysis.jl</title><meta name="title" content="Calibration (1D) · NMRAnalysis.jl"/><meta property="og:title" content="Calibration (1D) · NMRAnalysis.jl"/><meta property="twitter:title" content="Calibration (1D) · NMRAnalysis.jl"/><meta name="description" content="Documentation for NMRAnalysis.jl."/><meta property="og:description" content="Documentation for NMRAnalysis.jl."/><meta property="twitter:description" content="Documentation for NMRAnalysis.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NMRAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">Quick Start</a></li><li><span class="tocitem">Analyses</span><ul><li><a class="tocitem" href="../diffusion/">Diffusion (1D)</a></li><li><a class="tocitem" href="../relaxation/">Relaxation (1D)</a></li><li><a class="tocitem" href="../tract/">TRACT (1D)</a></li><li class="is-active"><a class="tocitem" href>Calibration (1D)</a><ul class="internal"><li><a class="tocitem" href="#The-analyse-Function"><span>The <code>analyse</code> Function</span></a></li><li><a class="tocitem" href="#19F-Nutation-Calibration"><span>19F Nutation Calibration</span></a></li><li><a class="tocitem" href="#Required-Pulse-Sequence-Annotations"><span>Required Pulse Sequence Annotations</span></a></li><li><a class="tocitem" href="#Theoretical-Background"><span>Theoretical Background</span></a></li><li><a class="tocitem" href="#Integration-with-R1rho-Experiments"><span>Integration with R1rho Experiments</span></a></li></ul></li><li><a class="tocitem" href="../r1rho/">R1ρ (1D)</a></li><li><a class="tocitem" href="../2d-fitting/">2D experiments</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/r1rho/">19F R1ρ acquisition &amp; analysis</a></li></ul></li><li><span class="tocitem">Advanced</span><ul><li><a class="tocitem" href="../../advanced/creating_2d_analyses/">Creating new 2D analyses</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../indexes/">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Analyses</a></li><li class="is-active"><a href>Calibration (1D)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Calibration (1D)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRAnalysis.jl/blob/main/docs/src/analyses/calibration.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="1D-Calibration-Analysis"><a class="docs-heading-anchor" href="#1D-Calibration-Analysis">1D Calibration Analysis</a><a id="1D-Calibration-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#1D-Calibration-Analysis" title="Permalink"></a></h1><p>The calibration analysis module in NMRAnalysis.jl provides tools for analyzing pulse calibration experiments. These experiments are essential for determining accurate pulse lengths and power levels before running relaxation or other quantitative NMR experiments.</p><h2 id="The-analyse-Function"><a class="docs-heading-anchor" href="#The-analyse-Function">The <code>analyse</code> Function</a><a id="The-analyse-Function-1"></a><a class="docs-heading-anchor-permalink" href="#The-analyse-Function" title="Permalink"></a></h2><p>NMRAnalysis.jl provides a generic <code>analyse()</code> function that automatically detects experiment types based on pulse sequence annotations and dispatches to the appropriate analysis routine.</p><pre><code class="language-julia hljs">using NMRAnalysis
analyse(&quot;path/to/experiment&quot;)</code></pre><p>The function reads metadata from the NMR experiment to determine:</p><ul><li><strong>Experiment type</strong>: e.g., &quot;1d&quot;, &quot;calibration&quot;</li><li><strong>Features</strong>: e.g., &quot;nutation&quot;</li></ul><p>Based on these annotations, it calls the appropriate analysis function automatically.</p><h2 id="19F-Nutation-Calibration"><a class="docs-heading-anchor" href="#19F-Nutation-Calibration">19F Nutation Calibration</a><a id="19F-Nutation-Calibration-1"></a><a class="docs-heading-anchor-permalink" href="#19F-Nutation-Calibration" title="Permalink"></a></h2><p>Nutation experiments measure the B1 field strength by varying the pulse duration and observing the resulting oscillation in signal intensity. This is particularly useful for calibrating spinlock powers in R1rho experiments.</p><h3 id="Pulse-Program"><a class="docs-heading-anchor" href="#Pulse-Program">Pulse Program</a><a id="Pulse-Program-1"></a><a class="docs-heading-anchor-permalink" href="#Pulse-Program" title="Permalink"></a></h3><p>The pulse program for 19F nutation calibration is available at:</p><ul><li><strong><a href="https://waudbylab.org/pulseprograms/sequences/19f_calib_nut.cw/"><code>19f_calib_nut.cw</code></a></strong></li></ul><p>This sequence includes annotations that enable automatic analysis by NMRAnalysis.jl.</p><h3 id="Example-Usage"><a class="docs-heading-anchor" href="#Example-Usage">Example Usage</a><a id="Example-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Usage" title="Permalink"></a></h3><p>To analyse a nutation calibration experiment:</p><pre><code class="language-julia hljs">using NMRAnalysis
analyse(&quot;examples/calibration/1&quot;)</code></pre><p>This produces console output with the calibration results:</p><pre><code class="nohighlight hljs">[ Info: Analysing calibration by nutation on examples/calibration/1
[ Info:  - Power level: 16.997737581326444 dB
[ Info:  - Nutation frequency ν₁: 1010.6 ± 5.7 Hz
[ Info:  - 90° pulse length: 247.4 ± 1.4 μs
[ Info:  - Decay rate: 327.0 ± 69.0 s⁻¹
[ Info:  - B₁ inhomogeneity (R/2πν₁): 5.1 ± 1.1 %</code></pre><p>A plot is also displayed showing the nutation data and fit:</p><p><img src="../../assets/calibration_19f_nutation.png" alt="19F Nutation Calibration"/></p><h3 id="Return-Value"><a class="docs-heading-anchor" href="#Return-Value">Return Value</a><a id="Return-Value-1"></a><a class="docs-heading-anchor-permalink" href="#Return-Value" title="Permalink"></a></h3><p>The function returns a named tuple containing:</p><table><tr><th style="text-align: right">Field</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>pulse90</code></td><td style="text-align: right">90° pulse duration in seconds (with uncertainty)</td></tr><tr><td style="text-align: right"><code>nut_hz</code></td><td style="text-align: right">Nutation frequency in Hz (with uncertainty)</td></tr><tr><td style="text-align: right"><code>power_level</code></td><td style="text-align: right">Power level used in the experiment</td></tr><tr><td style="text-align: right"><code>plt</code></td><td style="text-align: right">Plot object showing data and fit</td></tr></table><pre><code class="language-julia hljs">julia&gt; result = analyse(&quot;examples/calibration/1&quot;)
(pulse90 = 0.0002474 ± 1.4e-6, nut_hz = 1010.6 ± 5.7, power_level = Power(16.997737581326444 dB, 0.019963019999999998 W), plt = Plot{Plots.GRBackend() n=2})</code></pre><h2 id="Required-Pulse-Sequence-Annotations"><a class="docs-heading-anchor" href="#Required-Pulse-Sequence-Annotations">Required Pulse Sequence Annotations</a><a id="Required-Pulse-Sequence-Annotations-1"></a><a class="docs-heading-anchor-permalink" href="#Required-Pulse-Sequence-Annotations" title="Permalink"></a></h2><p>For automatic analysis, the pulse sequence must include the following annotations:</p><table><tr><th style="text-align: right">Annotation</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>calibration.channel</code></td><td style="text-align: right">Channel to use for calibration (e.g., &quot;f1&quot;)</td></tr><tr><td style="text-align: right"><code>calibration.power</code></td><td style="text-align: right">Power level used in the experiment</td></tr><tr><td style="text-align: right"><code>calibration.duration</code></td><td style="text-align: right">Array of pulse durations used</td></tr><tr><td style="text-align: right"><code>calibration.model</code></td><td style="text-align: right">Model to fit: <code>&quot;sine_modulated&quot;</code> or <code>&quot;cosine_modulated&quot;</code></td></tr></table><h3 id="Optional-Annotations"><a class="docs-heading-anchor" href="#Optional-Annotations">Optional Annotations</a><a id="Optional-Annotations-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-Annotations" title="Permalink"></a></h3><table><tr><th style="text-align: right">Annotation</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>calibration.offset</code></td><td style="text-align: right">Offset in ppm to select the observed signal (default: 0.0)</td></tr></table><h2 id="Theoretical-Background"><a class="docs-heading-anchor" href="#Theoretical-Background">Theoretical Background</a><a id="Theoretical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-Background" title="Permalink"></a></h2><h3 id="Nutation-Model"><a class="docs-heading-anchor" href="#Nutation-Model">Nutation Model</a><a id="Nutation-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Nutation-Model" title="Permalink"></a></h3><p>The nutation experiment measures signal intensity as a function of pulse duration. For a pulse applied on-resonance, the signal follows a damped oscillation:</p><p><strong>Sine-modulated</strong> (starting from equilibrium):</p><p class="math-container">\[I(t) = A \cdot \sin(2\pi \nu_1 t) \cdot \exp(-R \cdot t)\]</p><p><strong>Cosine-modulated</strong> (starting from transverse magnetization):</p><p class="math-container">\[I(t) = A \cdot \cos(2\pi \nu_1 t) \cdot \exp(-R \cdot t)\]</p><p>Where:</p><ul><li><span>$\nu_1$</span> is the nutation frequency (B1 field strength in Hz)</li><li><span>$R$</span> is the decay rate due to B1 inhomogeneity and relaxation</li><li><span>$A$</span> is the amplitude</li></ul><h3 id="Calculated-Parameters"><a class="docs-heading-anchor" href="#Calculated-Parameters">Calculated Parameters</a><a id="Calculated-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Calculated-Parameters" title="Permalink"></a></h3><p>From the fitted nutation frequency, the 90° pulse length is calculated as:</p><p class="math-container">\[t_{90} = \frac{1}{4 \nu_1}\]</p><p>The B1 inhomogeneity is estimated from the ratio of the decay rate to the nutation frequency:</p><p class="math-container">\[\text{B}_1 \text{ inhomogeneity} = \frac{R}{2\pi \nu_1}\]</p><p>A typical B1 inhomogeneity of 5-10% is expected for standard NMR probes.</p><h2 id="Integration-with-R1rho-Experiments"><a class="docs-heading-anchor" href="#Integration-with-R1rho-Experiments">Integration with R1rho Experiments</a><a id="Integration-with-R1rho-Experiments-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-R1rho-Experiments" title="Permalink"></a></h2><p>Calibration experiments can be used directly with <code>setupR1rhopowers()</code> to calculate spinlock power levels. See the <a href="../../tutorials/r1rho/">R1rho tutorial</a> for details.</p><pre><code class="language-julia hljs">setupR1rhopowers(&quot;examples/calibration/1&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tract/">« TRACT (1D)</a><a class="docs-footer-nextpage" href="../r1rho/">R1ρ (1D) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 27 January 2026 18:42">Tuesday 27 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
