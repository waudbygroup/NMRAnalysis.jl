<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>19F R1ρ acquisition &amp; analysis · NMRAnalysis.jl</title><meta name="title" content="19F R1ρ acquisition &amp; analysis · NMRAnalysis.jl"/><meta property="og:title" content="19F R1ρ acquisition &amp; analysis · NMRAnalysis.jl"/><meta property="twitter:title" content="19F R1ρ acquisition &amp; analysis · NMRAnalysis.jl"/><meta name="description" content="Documentation for NMRAnalysis.jl."/><meta property="og:description" content="Documentation for NMRAnalysis.jl."/><meta property="twitter:description" content="Documentation for NMRAnalysis.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NMRAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">Quick Start</a></li><li><span class="tocitem">Analyses</span><ul><li><a class="tocitem" href="../../analyses/diffusion/">Diffusion (1D)</a></li><li><a class="tocitem" href="../../analyses/relaxation/">Relaxation (1D)</a></li><li><a class="tocitem" href="../../analyses/tract/">TRACT (1D)</a></li><li><a class="tocitem" href="../../analyses/r1rho/">R1ρ (1D)</a></li><li><a class="tocitem" href="../../analyses/2d-fitting/">2D experiments</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>19F R1ρ acquisition &amp; analysis</a><ul class="internal"><li><a class="tocitem" href="#Experimental-Setup"><span>Experimental Setup</span></a></li><li><a class="tocitem" href="#GUI-Overview"><span>GUI Overview</span></a></li><li><a class="tocitem" href="#Analysis-Workflow"><span>Analysis Workflow</span></a></li></ul></li></ul></li><li><span class="tocitem">Advanced</span><ul><li><a class="tocitem" href="../../advanced/creating_2d_analyses/">Creating new 2D analyses</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../indexes/">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>19F R1ρ acquisition &amp; analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>19F R1ρ acquisition &amp; analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/waudbygroup/NMRAnalysis.jl/blob/main/docs/src/tutorials/r1rho.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial:-R1ρ-Analysis"><a class="docs-heading-anchor" href="#Tutorial:-R1ρ-Analysis">Tutorial: R1ρ Analysis</a><a id="Tutorial:-R1ρ-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial:-R1ρ-Analysis" title="Permalink"></a></h1><p>This tutorial walks through the graphical interface for analysing R1ρ relaxation dispersion data. It covers experimental setup, GUI controls, fitting workflow, and interpretation of results.</p><h2 id="Experimental-Setup"><a class="docs-heading-anchor" href="#Experimental-Setup">Experimental Setup</a><a id="Experimental-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Experimental-Setup" title="Permalink"></a></h2><h3 id="1.-Determine-the-Ligand-Chemical-Shift"><a class="docs-heading-anchor" href="#1.-Determine-the-Ligand-Chemical-Shift">1. Determine the Ligand Chemical Shift</a><a id="1.-Determine-the-Ligand-Chemical-Shift-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Determine-the-Ligand-Chemical-Shift" title="Permalink"></a></h3><p>Acquire a 1D broadband <span>$^{19}$</span>F NMR experiment to identify the chemical shift of the ligand resonance. This value will serve as the O1 in the 90° pulse calibration experiment. Ensure that the pulse length (<code>p1</code>) is set appropriately in subsequent <span>$R_{1\rho}$</span> experiments.</p><h3 id="2.-Pulse-Program"><a class="docs-heading-anchor" href="#2.-Pulse-Program">2. Pulse Program</a><a id="2.-Pulse-Program-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Pulse-Program" title="Permalink"></a></h3><p>The pulse program used for on-resonance <span>$R_{1ρ}$</span> experiments is available on GitHub:</p><ul><li><strong><a href="https://github.com/chriswaudby/pp/blob/master/19F_onresR1p.cw"><code>19F_onresR1p.cw</code></a></strong>  </li></ul><p>This sequence is adapted from Overbeck et al. (J. Magn. Reson. 2020, <strong>74</strong>, 753–766) and includes improved temperature compensation. It supports pseudo-3D acquisition with variable spinlock lengths and powers, read in via <code>VPLIST</code> and <code>VALIST</code>.</p><blockquote><p>Make sure to calibrate your hard pulse and spinlock powers before running the sequence. See the calibration section below for details.</p></blockquote><h3 id="3.-Calibrate-Spinlock-Powers"><a class="docs-heading-anchor" href="#3.-Calibrate-Spinlock-Powers">3. Calibrate Spinlock Powers</a><a id="3.-Calibrate-Spinlock-Powers-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Calibrate-Spinlock-Powers" title="Permalink"></a></h3><p>NMRAnalysis.jl provides the function <code>setupR1rhopowers()</code> for calculating spinlock powers based on a calibrated <span>$^{19}$</span>F 90 degree hard pulse:</p><ul><li>Input the P1 value for the <span>$^{19}$</span>F hard pulse (in μs) and the PLdB1 (<span>$^{19}$</span>F hard pulse power in dB). </li><li>You may supply a custom list of spinlock strengths (in Hz), or use the default set provided.</li><li>For high spinlock powers, a warning will be issued to verify that the spinlock duration remains within acceptable power limits. </li><li>The output is a list of calibrated spinlock powers (in dB) that can be copied directly into VALIST in TopSpin. </li></ul><p><img src="../../assets/setupR1rhopowers.png" alt="setupR1rhopowers"/></p><h2 id="GUI-Overview"><a class="docs-heading-anchor" href="#GUI-Overview">GUI Overview</a><a id="GUI-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#GUI-Overview" title="Permalink"></a></h2><p>Open a Julia session in the terminal and launch the analysis interface:</p><pre><code class="language-julia hljs">using NMRAnalysis

# prompt to select experiments
r1rho()

# provide path to directory containing experiments
r1rho(&quot;example/R1rho&quot;)

# provide path to specific experiments
r1rho([&quot;example/R1rho/11&quot;, &quot;example/R1rho/12&quot;])</code></pre><p>Once loaded, the GUI displays the first spectrum of the dataset.</p><p><img src="../../assets/r1rho-interface.png" alt="R1ρ Analysis Interface"/></p><ul><li><strong>Series Toggle</strong>: Switch between measurements at different spin-lock field strengths.</li><li><strong>Integration Width</strong>: Manually input a value or click <strong>Optimise</strong> to automatically minimize fitting error.</li><li><strong>Peak Position (ppm)</strong>: Automatically set to the chemical shift of a ligand; manually adjust accordingly if analysing a mixture.</li><li><strong>Noise Position (ppm)</strong>: Automatically placed away from the peak; adjust if baseline noise is misestimated.</li><li><strong>Initial Guesses</strong>: Provide starting values for <span>$R_{2,0}$</span>, <span>$R_\mathrm{ex}$</span>, and <span>$k_\mathrm{ex}$</span> to guide model fitting.</li><li><strong>Δδ stdev (ppm)</strong>: Accounts for uncertainty in the chemical shift difference between free and bound states. Assumes a normal distribution centered at 0 ppm with a standard deviation of 2 ppm.</li><li><strong>Output Folder</strong>: Specify a name for your results folder to keep outputs organised.</li><li><strong>Save Results</strong>: Export fitted parameters and plots to the output folder.</li></ul><h2 id="Analysis-Workflow"><a class="docs-heading-anchor" href="#Analysis-Workflow">Analysis Workflow</a><a id="Analysis-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-Workflow" title="Permalink"></a></h2><h3 id="1.-Visualise-the-Spectrum"><a class="docs-heading-anchor" href="#1.-Visualise-the-Spectrum">1. Visualise the Spectrum</a><a id="1.-Visualise-the-Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Visualise-the-Spectrum" title="Permalink"></a></h3><ul><li>The top panel displays the observed spectrum at a given spin-lock field strength (<span>$ν_{SL}$</span>).</li><li>Peak and noise positions are marked and can be adjusted by dragging.</li><li>Set the <strong>Integration Width</strong> to define the region used for peak fitting.</li></ul><h3 id="2.-Fit-the-Data"><a class="docs-heading-anchor" href="#2.-Fit-the-Data">2. Fit the Data</a><a id="2.-Fit-the-Data-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Fit-the-Data" title="Permalink"></a></h3><ul><li>Click <strong>Optimise</strong> to refine the integration width automatically.</li><li>Input initial guesses for model parameters:<ul><li><span>$R_{2,0}$</span>: Baseline transverse relaxation rate</li><li><span>$R_\mathrm{ex}$</span>: Exchange contribution to relaxation</li><li><span>$k_\mathrm{ex}$</span>: Exchange rate constant</li></ul></li><li>The GUI fits the data and overlays model curves on the plots.</li></ul><h3 id="3.-Interpret-the-Results"><a class="docs-heading-anchor" href="#3.-Interpret-the-Results">3. Interpret the Results</a><a id="3.-Interpret-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Interpret-the-Results" title="Permalink"></a></h3><p>Signal intensities are fit globally as a function of relaxation time and spin-lock field strength:</p><p class="math-container">\[I(T_{\text{SL}}, \nu_{\text{SL}}) = I_0 \cdot \exp\left(-\left[R_{2,0} + \frac{R_{\text{ex}} \cdot K^2}{K^2 + 4\pi^2 \nu_{\text{SL}}^2}\right] \cdot T_{\text{SL}}\right)\]</p><p><em>Adapted from Trott &amp; Palmer (2002), J. Magn. Reson. 154, 157–160.</em></p><p>where:</p><p class="math-container">\[K^2 = k_{\text{ex}}^2 + 4\pi^2 \Delta\nu^2\]</p><p>To assess whether exchange contributes significantly, a null model excluding <span>$R_\mathrm{ex}$</span> is also fit and compared using an F-test.</p><h4 id="Dispersion-Curve"><a class="docs-heading-anchor" href="#Dispersion-Curve">Dispersion Curve</a><a id="Dispersion-Curve-1"></a><a class="docs-heading-anchor-permalink" href="#Dispersion-Curve" title="Permalink"></a></h4><p>The GUI plots <span>$R_{1ρ}$</span> as a function of <span>$ν_{SL}$</span> using fitted parameters:</p><p class="math-container">\[R_{1\rho} = R_{2,0} + \frac{R_{\text{ex}} \cdot K^2}{K^2 + 4\pi^2 \nu_{\text{SL}}^2}\]</p><p>This curve is overlaid with <span>$R_{1ρ}$</span> values obtained from exponential fits at individual spin-lock field strengths, enabling visual comparison of model performance.</p><h4 id="Chemical-Shift-Correction"><a class="docs-heading-anchor" href="#Chemical-Shift-Correction">Chemical Shift Correction</a><a id="Chemical-Shift-Correction-1"></a><a class="docs-heading-anchor-permalink" href="#Chemical-Shift-Correction" title="Permalink"></a></h4><p>To account for uncertainty in the chemical shift difference (<span>$Δδ$</span>), a particle-based Monte Carlo correction is applied to <span>$K$</span>. For each particle, <span>$k_\mathrm{off}$</span> is calculated as:</p><p class="math-container">\[k_\mathrm{off} \approx k_\mathrm{ex} = \sqrt{K^2 - 4\pi^2 \Delta\nu^2}\]</p><p>Samples yielding nonphysical values are excluded, and the final estimate is reported as the mean ± standard deviation of valid particles.</p><h3 id="4.-Output-Files"><a class="docs-heading-anchor" href="#4.-Output-Files">4. Output Files</a><a id="4.-Output-Files-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Output-Files" title="Permalink"></a></h3><p>Upon saving results, the GUI generates both raw and fitted data files, along with summary plots. These outputs are organized by analysis type:</p><h4 id="Dispersion-Curve-Outputs"><a class="docs-heading-anchor" href="#Dispersion-Curve-Outputs">Dispersion Curve Outputs</a><a id="Dispersion-Curve-Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Dispersion-Curve-Outputs" title="Permalink"></a></h4><p>These files correspond to the global fit of <span>$R_{1ρ}$</span> versus spinlock field strength:</p><ul><li><code>dispersion-points.csv</code>: Raw <span>$R_{1ρ}$</span> values from exponential fits at each spinlock field</li><li><code>dispersion-fit.csv</code>: Fitted <span>$R_{1ρ}$</span> values based on the global model</li><li><code>dispersion.pdf</code>: Plot of the dispersion curve with overlaid model fit</li></ul><p><img src="../../assets/example_results_file.png" alt="dispersion.pdf"/></p><h4 id="Peak-Integral-Outputs"><a class="docs-heading-anchor" href="#Peak-Integral-Outputs">Peak Integral Outputs</a><a id="Peak-Integral-Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Peak-Integral-Outputs" title="Permalink"></a></h4><p>For each spinlock power, the GUI exports:</p><ul><li><code>intensities_&lt;spinlock&gt;Hz-points.csv</code>: Raw peak intensities as a function of spinlock duration</li><li><code>intensities_&lt;spinlock&gt;Hz-fit.csv</code>: Fitted intensities using the relaxation model</li><li><code>intensities_&lt;spinlock&gt;Hz.pdf</code>: Plot of intensity decay curves with fitted overlays</li></ul><blockquote><p>These files support detailed inspection of signal decay and fitting quality at individual spinlock powers.</p></blockquote><h4 id="Summary-File:-results.txt"><a class="docs-heading-anchor" href="#Summary-File:-results.txt">Summary File: <code>results.txt</code></a><a id="Summary-File:-results.txt-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-File:-results.txt" title="Permalink"></a></h4><p>This file provides a concise summary of the analysis, including:</p><ul><li>Input file paths used in the fitting  </li><li>Peak and noise positions (ppm)  </li><li>Integration width  </li><li>Initial parameter guesses (<code>I0</code>, <code>R2,0</code>, <code>Rex</code>, <code>kex</code>)  </li><li>Final fitted values with uncertainties  </li></ul><p><strong>Example:</strong></p><p><img src="../../assets/example_results_file.png" alt="results_file"/></p><blockquote><p>This file is useful for quick reference and record-keeping, especially when comparing fits across multiple datasets or conditions.</p></blockquote></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../analyses/2d-fitting/">« 2D experiments</a><a class="docs-footer-nextpage" href="../../advanced/creating_2d_analyses/">Creating new 2D analyses »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 1 October 2025 14:07">Wednesday 1 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
