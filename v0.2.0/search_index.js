var documenterSearchIndex = {"docs":
[{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Modules = [NMRAnalysis]","category":"page"},{"location":"experiments/#2D-Experiments","page":"Creating new experiments","title":"2D Experiments","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"An abstract type representing a type of experimental NMR analysis. The type system is split between fixed-peak experiments (where peak positions are constant between spectra) and moving-peak experiments (where peak positions can vary).","category":"page"},{"location":"experiments/#Required-Fields","page":"Creating new experiments","title":"Required Fields","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"All concrete subtypes must include the following fields:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"specdata: A SpecData object containing the observed and simulated data plus mask\npeaks: An Observable list of peaks in the experiment\nclusters: An Observable list of clusters of peaks\ntouched: An Observable list of touched clusters\nisfitting: An Observable boolean indicating if real-time fitting is active\nxradius: An Observable number defining peak detection radius in x dimension\nyradius: An Observable number defining peak detection radius in y dimension\nstate: An Observable dictionary of GUI state variables","category":"page"},{"location":"experiments/#Required-Implementation","page":"Creating new experiments","title":"Required Implementation","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Concrete subtypes must implement both the core analysis functions below and the visualization functions documented separately. Note that many other functions have default implementations that can be used unless special behaviour is needed.","category":"page"},{"location":"experiments/#Type-Hierarchy","page":"Creating new experiments","title":"Type Hierarchy","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"The Experiment type has two immediate subtypes that handle position behaviour:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"FixedPeakExperiment: Implementation where hasfixedpositions(expt) = true\nMovingPeakExperiment: Implementation where hasfixedpositions(expt) = false","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Concrete experiment types should inherit from one of these intermediate types rather than directly from Experiment.","category":"page"},{"location":"experiments/#addpeak!(expt,-position,-[label],-[xradius],-[yradius])","page":"Creating new experiments","title":"addpeak!(expt, position, [label], [xradius], [yradius])","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Add a new peak to the experiment at the specified position.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"expt: The experiment\nposition: A Point2f specifying the (x,y) coordinates of the peak\nlabel: Optional string label for the peak (defaults to auto-generated)\nxradius: Optional peak radius in x dimension (defaults to experiment default)\nyradius: Optional peak radius in y dimension (defaults to experiment default)","category":"page"},{"location":"experiments/#simulate!(z,-peak,-expt,-[xbounds],-[ybounds])","page":"Creating new experiments","title":"simulate!(z, peak, expt, [xbounds], [ybounds])","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Simulate a single peak in the experiment.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"z: Array to store simulation results\npeak: The peak to simulate\nexpt: The experiment\nxbounds: Optional bounds for x dimension simulation\nybounds: Optional bounds for y dimension simulation","category":"page"},{"location":"experiments/#Default-Implementations","page":"Creating new experiments","title":"Default Implementations","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"The abstract type provides several default implementations that can be used as-is or overridden when needed:","category":"page"},{"location":"experiments/#mask!(z,-peak,-expt)","page":"Creating new experiments","title":"mask!(z, peak, expt)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Default implementation generates an elliptical mask for each peak using maskellipse!. Only needs to be overridden if a different peak shape is required.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"z: Array to store mask results\npeak: The peak to mask\nexpt: The experiment","category":"page"},{"location":"experiments/#postfit!(peak,-expt)","page":"Creating new experiments","title":"postfit!(peak, expt)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Perform additional fitting operations after spectrum fitting.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"peak: The peak to post-fit\nexpt: The experiment","category":"page"},{"location":"experiments/#slicelabel(expt,-idx)","page":"Creating new experiments","title":"slicelabel(expt, idx)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Generate a label for a specific slice/plane of the experiment.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"expt: The experiment\nidx: The slice index","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Returns:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"A string label for the slice","category":"page"},{"location":"experiments/#peakinfotext(expt,-idx)","page":"Creating new experiments","title":"peakinfotext(expt, idx)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Generate information text about a specific peak.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"expt: The experiment\nidx: The peak index","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Returns:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"A string containing formatted peak information","category":"page"},{"location":"experiments/#experimentinfo(expt)","page":"Creating new experiments","title":"experimentinfo(expt)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Generate information text about the experiment.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Returns:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"A string containing formatted experiment information","category":"page"},{"location":"experiments/#completestate!(state,-expt)","page":"Creating new experiments","title":"completestate!(state, expt)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Set up observables for the GUI state.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"state: The GUI state dictionary\nexpt: The experiment","category":"page"},{"location":"experiments/#Functions-Handled-by-Abstract-Type","page":"Creating new experiments","title":"Functions Handled by Abstract Type","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"The following functions are implemented generically and do not need to be reimplemented by concrete subtypes:","category":"page"},{"location":"experiments/#Peak-Management","page":"Creating new experiments","title":"Peak Management","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"nslices(expt): Get the number of slices in the experiment\nnpeaks(expt): Get the number of peaks in the experiment\nmovepeak!(expt, idx, newpos): Move a peak to a new position\ndeletepeak!(expt, idx): Delete a specific peak\ndeleteallpeaks!(expt): Delete all peaks","category":"page"},{"location":"experiments/#Data-Processing","page":"Creating new experiments","title":"Data Processing","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"mask!(z, peaks, expt): Calculate peak masks and update internal specdata\nsimulate!(z, peaks, expt): Simulate the experiment and update internal specdata\nfit!(expt): Fit the peaks in the experiment\nfit!(cluster, expt): Fit a specific cluster of peaks\nchecktouched!(expt): Check which clusters have been modified","category":"page"},{"location":"experiments/#Observable-Setup","page":"Creating new experiments","title":"Observable Setup","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"setupexptobservables!(expt): Set up reactive behaviours for experiment observables","category":"page"},{"location":"experiments/#Required-Visualization-Functions","page":"Creating new experiments","title":"Required Visualization Functions","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Concrete subtypes must implement the following visualization functions:","category":"page"},{"location":"experiments/#makepeakplot!(gui,-state,-expt)","page":"Creating new experiments","title":"makepeakplot!(gui, state, expt)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Create the interactive peak plot in the GUI context. This function is crucial for real-time visualization and interaction.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"gui: The GUI context containing plot panels\nstate: The GUI state dictionary\nexpt: The experiment","category":"page"},{"location":"experiments/#save_peak_plots!(expt,-folder)","page":"Creating new experiments","title":"save_peak_plots!(expt, folder)","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Save publication-quality plots for all peaks to a specified folder.","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Arguments:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"expt: The experiment\nfolder: String path to the output folder","category":"page"},{"location":"experiments/#Utility-Functions","page":"Creating new experiments","title":"Utility Functions","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"bounds(mask): Calculate bounds from a mask\npeak_plot_data(peak, expt): Extract plotting data for a single peak\nplot_peak!(ax, peak, expt): Plot a single peak's data","category":"page"},{"location":"experiments/#Implemented-Experiment-Types","page":"Creating new experiments","title":"Implemented Experiment Types","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"The codebase includes implementations for several specific experiment types:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"RelaxationExperiment: For relaxation measurements\nHetNOEExperiment: For heteronuclear NOE measurements\nPREExperiment: For paramagnetic relaxation enhancement measurements","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Each implementation specialises the simulation and fitting behaviour for its specific experiment type while inheriting the common functionality from the abstract type.","category":"page"},{"location":"experiments/#Guide:-Creating-a-New-Experiment-Type","page":"Creating new experiments","title":"Guide: Creating a New Experiment Type","text":"","category":"section"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Here's a step-by-step guide to implementing a new type of NMR experiment:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Choose Base Type\nInherit from FixedPeakExperiment if peak positions are constant between spectra\nInherit from MovingPeakExperiment if peak positions can vary\nDefine Structure\nstruct MyNewExperiment <: FixedPeakExperiment\n    # Required fields\n    specdata\n    peaks\n    clusters\n    touched\n    isfitting\n    xradius\n    yradius\n    state\n    \n    # Experiment-specific fields\n    my_special_parameter\nend\nConstructor\nCreate a constructor that initializes all required fields\nSet up observables using setupexptobservables!\nInitialize experiment-specific parameters\nCore Analysis Functions\nImplement addpeak! to set up experiment-specific peak parameters\nfunction addpeak!(expt::MyNewExperiment, initialposition::Point2f, label=\"\")\n    # Create basic peak\n    newpeak = Peak(initialposition, label)\n    \n    # Add experiment-specific parameters\n    newpeak.parameters[:my_param] = Parameter(\"My Parameter\", initial_value)\n    \n    # Add post-fit parameters that will be saved in results\n    newpeak.postparameters[:final_result] = Parameter(\"Final Result\", 0.0)\n    \n    push!(expt.peaks[], newpeak)\n    notify(expt.peaks)\nend\nImplement simulate! for your specific peak shapes/behavior\nImplement postfit! to calculate final parameters from fit results\nInformation Functions\nImplement slicelabel for spectrum navigation\nImplement peakinfotext to show fit results\nImplement experimentinfo to show experiment details\nVisualization Functions\nImplement makepeakplot! for the interactive GUI\nfunction makepeakplot!(gui, state, expt::MyNewExperiment)\n    # Create appropriate plot(s) for your data\n    gui[:axpeakplot] = ax = Axis(gui[:panelpeakplot][1,1],\n                               xlabel=\"My X Label\",\n                               ylabel=\"My Y Label\")\n    # Add plot elements\n    plot!(ax, ...)\nend\nImplement save_peak_plots! for publication figures\nfunction save_peak_plots!(expt::MyNewExperiment, folder::AbstractString)\n    CairoMakie.activate!()\n    for peak in expt.peaks[]\n        fig = Figure()\n        # Create publication-quality figure\n        save(joinpath(folder, \"peak_$(peak.label[]).pdf\"), fig)\n    end\n    GLMakie.activate!()\nend\nOptional Overrides\nOverride mask! only if you need non-elliptical peak shapes\nOverride clustering functions only if you need special peak grouping\nOverride other default implementations only if needed","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Remember:","category":"page"},{"location":"experiments/","page":"Creating new experiments","title":"Creating new experiments","text":"Post-fit parameters (postparameters) are what get saved in results files\nPeak parameters (parameters) are used during fitting\nUse the existing implementations (RelaxationExperiment, HetNOEExperiment, PREExperiment) as templates\nMost functionality can be inherited from the abstract type","category":"page"},{"location":"indexes/#Index","page":"Index","title":"Index","text":"","category":"section"},{"location":"indexes/","page":"Index","title":"Index","text":"Modules = [NMRAnalysis]","category":"page"},{"location":"#NMRAnalysis.jl","page":"Home","title":"NMRAnalysis.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"A Julia package for analysis of biomolecular NMR data, with particular focus on protein dynamics experiments.","category":"page"},{"location":"#Overview","page":"Home","title":"Overview","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"NMRAnalysis.jl provides tools for processing and analyzing various types of NMR experiments commonly used in biomolecular NMR:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Relaxation measurements (T1, T2)\nHeteronuclear NOE\nDiffusion\nTRACT (TROSY/anti-TROSY Cross-Correlated Relaxation)","category":"page"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using NMRAnalysis\n\n# Set your working directory to where your NMR data is located\ncd(\"/path/to/nmr/data\")\n\n# Analyze 2D relaxation data\nrelaxation2d(\"expno\", \"vdlist\")\n\n# Analyze heteronuclear NOE data\nhetnoe2d([\"reference/pdata/1\", \"saturated/pdata/1\"], [false, true])\n\n# Run diffusion analysis\ndiffusion()\n\n# Run TRACT analysis\ntract()","category":"page"},{"location":"#Key-Functions","page":"Home","title":"Key Functions","text":"","category":"section"},{"location":"#2D-Analysis-with-Interactive-GUI","page":"Home","title":"2D Analysis with Interactive GUI","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"relaxation2d(experimentfiles, relaxationtimes): Analyze T1/T2 relaxation data\nhetnoe2d(planefilenames, saturation): Analyze heteronuclear NOE data","category":"page"},{"location":"#1D-Analysis-with-Guided-Interface","page":"Home","title":"1D Analysis with Guided Interface","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"diffusion([coherence]): Analyze diffusion experiments\ntract(): Analyze TRACT experiments for estimating rotational correlation times","category":"page"},{"location":"#Utility-Functions","page":"Home","title":"Utility Functions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"viscosity(solvent, T): Calculate solvent viscosity at given temperature\nSupports :h2o and :d2o\nUses model from Cho et al, J Phys Chem B (1999) 103 1991-1994","category":"page"},{"location":"#Data-Input","page":"Home","title":"Data Input","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The package supports various Bruker data formats:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Single experiment directories (e.g., \".../11\")\nMultiple experiment directories\nProcessed data directories (e.g., \".../pdata/1\")\nVariable delay lists (for relaxation experiments)","category":"page"},{"location":"#Usage-Example","page":"Home","title":"Usage Example","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"# Analyze T2 relaxation data from multiple processed spectra\nrelaxation2d(\n    [\"expno/pdata/231\",  # First spectrum\n     \"expno/pdata/232\",  # Second spectrum\n     \"expno/pdata/233\"], # Third spectrum\n    [0.01, 0.03, 0.05]   # Relaxation delays in seconds\n)\n\n# Analyze hetNOE data from reference/saturated pair\nhetnoe2d(\n    [\"reference/pdata/1\",\n     \"saturated/pdata/1\"],\n    [false, true]\n)","category":"page"},{"location":"#Interactive-Analysis","page":"Home","title":"Interactive Analysis","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The 2D analysis functions provide an interactive GUI for:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Peak picking\nFitting\nVisual validation\nData export","category":"page"},{"location":"","page":"Home","title":"Home","text":"The 1D analysis functions provide guided command-line interfaces for:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Parameter input\nRegion selection\nData fitting\nFigure generation","category":"page"},{"location":"#Output","page":"Home","title":"Output","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"All analysis functions provide:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Fitted parameters with uncertainties\nPublication-quality figures\nOptions to save results","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [NMRAnalysis]","category":"page"}]
}
